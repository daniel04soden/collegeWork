# vary

[\[\[<https://img.shields.io/npm/v/vary.svg>](https://npmjs.org/package/vary)\]\]
[\[\[<https://img.shields.io/npm/dm/vary.svg>](https://npmjs.org/package/vary)\]\]
[\[\[<https://img.shields.io/node/v/vary.svg>](https://nodejs.org/en/download)\]\]
[\[\[<https://img.shields.io/travis/jshttp/vary/master.svg>](https://travis-ci.org/jshttp/vary)\]\]
[\[\[<https://img.shields.io/coveralls/jshttp/vary/master.svg>](https://coveralls.io/r/jshttp/vary)\]\]

Manipulate the HTTP Vary header

## Installation

This is a [Node.js](https://nodejs.org/en/) module available through the
[npm registry](https://www.npmjs.com/). Installation is done using the
[`npm install`{.verbatim}
command](https://docs.npmjs.com/getting-started/installing-npm-packages-locally):

``` {.bash org-language="sh"}
$ npm install vary
```

## API

<!-- eslint-disable no-unused-vars -->

``` {.javascript org-language="js"}
var vary = require('vary')
```

### vary(res, field)

Adds the given header `field`{.verbatim} to the `Vary`{.verbatim}
response header of `res`{.verbatim}. This can be a string of a single
field, a string of a valid `Vary`{.verbatim} header, or an array of
multiple fields.

This will append the header if not already listed, otherwise leaves it
listed in the current location.

<!-- eslint-disable no-undef -->

``` {.javascript org-language="js"}
// Append "Origin" to the Vary header of the response
vary(res, 'Origin')
```

### vary.append(header, field)

Adds the given header `field`{.verbatim} to the `Vary`{.verbatim}
response header string `header`{.verbatim}. This can be a string of a
single field, a string of a valid `Vary`{.verbatim} header, or an array
of multiple fields.

This will append the header if not already listed, otherwise leaves it
listed in the current location. The new header string is returned.

<!-- eslint-disable no-undef -->

``` {.javascript org-language="js"}
// Get header string appending "Origin" to "Accept, User-Agent"
vary.append('Accept, User-Agent', 'Origin')
```

## Examples

### Updating the Vary header when content is based on it

``` {.javascript org-language="js"}
var http = require('http')
var vary = require('vary')

http.createServer(function onRequest (req, res) {
  // about to user-agent sniff
  vary(res, 'User-Agent')

  var ua = req.headers['user-agent'] || ''
  var isMobile = /mobi|android|touch|mini/i.test(ua)

  // serve site, depending on isMobile
  res.setHeader('Content-Type', 'text/html')
  res.end('You are (probably) ' + (isMobile ? '' : 'not ') + 'a mobile user')
})
```

## Testing

``` {.bash org-language="sh"}
$ npm test
```

## License

[MIT](LICENSE)
